# Database Schema

The system uses **Supabase (PostgreSQL)** as the central data hub.

## Tables

### 1. `raw_race_data`
Stores raw strings fetched from JRA-VAN via JVLink.

| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | uuid | Primary Key |
| `race_id` | text | Unique ID (e.g., `0B15_20250201_1`) |
| `data_type` | text | JRA-VAN Data Spec (e.g., `0B15` for Race Card) |
| `content` | jsonb | Raw data content (Date, Raw String) |
| `status` | text | Processing status (`pending`, `processed`) |
| `timestamp` | timestamp | Upload time |

### 2. `bet_queue`
Queue for bets generated by the Brain and awaiting execution by the Shopper.

| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | uuid | Primary Key |
| `race_id` | text | Target Race ID |
| `horse_num` | int | Horse Number |
| `bet_type` | text | Bet Type (e.g., `WIN` for Tansho) |
| `amount` | int | Wager amount (JPY) |
| `status` | text | `approved` (Ready to buy), `purchased`, `failed` |
| `created_at` | timestamp | Creation time |

### 3. `race_results` (Planned)
Stores final race results to calculate profit/loss and update the model.

| Column | Type | Description |
| :--- | :--- | :--- |
| `race_id` | text | Primary Key |
| `rank_1_horse` | int | Winning Horse Number |
| `payoff_win` | int | Win Payoff (Yen) |
| `data_raw` | jsonb | Full result data |
